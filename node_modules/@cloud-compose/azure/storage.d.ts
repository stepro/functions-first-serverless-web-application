import * as compose from "@cloud-compose/compose";
import * as azure from "./azure";
import * as sdk from "azure-storage";

export enum AccountKind {
    storageV1 = "StorageV1",
    storageV2 = "StorageV2",
    blobStorage = "BlobStorage"
}

export enum Performance {
    standard = "Standard",
    premium = "Premium"
}

export enum Replication {
    locallyRedundant = "LRS",
    zoneRedundant = "ZRS",
    geoRedundant = "GRS",
    readAccessGeoRedundant = "RA-GRS"
}

export enum AccessTier {
    cool = "Cool",
    hot = "Hot"
}

export interface AccountProperties extends azure.ResourceProperties {
    kind?: AccountKind;
    performance?: Performance;
    replication?: Replication;
    requireHttps?: boolean;
}

export interface AccountSpec extends AccountProperties, azure.ResourceSpec<Account, AccountSpec, AccountProperties> { }

export interface PrimaryEndpoints {
    readonly blob: URL;
    readonly file: URL;
    readonly queue: URL;
    readonly web: URL;
}

export interface AccountKeys {
    readonly key1: string;
    readonly key2: string;
}

export interface Account extends azure.Resource<Account, AccountSpec, AccountProperties> {
    readonly primaryEndpoints: PrimaryEndpoints;
    readonly keys: AccountKeys;
    createBlobClient(): sdk.BlobService;
    createFileClient(): sdk.FileService;
    createQueueClient(): sdk.QueueService;
    createTableClient(): sdk.TableService;
}

export declare let account: azure.ResourceType<Account, AccountSpec, AccountProperties>;

export enum PublicAccessLevel {
    private = "private",
    blob = "blob",
    container = "container"
}

export interface ContainerProperties extends compose.Properties {
    account?: AccountProperties | compose.Reference<Account, AccountSpec, AccountProperties>;
    publicAccessLevel?: PublicAccessLevel;
}

export interface ContainerSpec extends ContainerProperties, compose.Spec<Container, ContainerSpec, ContainerProperties> {
    account: AccountSpec;
}

export interface Container extends compose.Service<Container, ContainerSpec, ContainerProperties> {
    account: Account;
    primaryEndpoint: URL;
    createClient(): sdk.BlobService;
}

export declare let container: compose.Type<Container, ContainerSpec, ContainerProperties>;

export interface WebsiteProperties extends compose.Properties {
    account?: AccountProperties | compose.Reference<Account, AccountSpec, AccountProperties>;
    indexDocument?: string;
    errorDocument?: string;
}

export interface WebsiteSpec extends WebsiteProperties, compose.Spec<Website, WebsiteSpec, WebsiteProperties> {
    account: AccountSpec;
}

export interface Website extends compose.Service<Website, WebsiteSpec, WebsiteProperties> {
    account: Account;
    primaryEndpoint: URL;
    createClient(): sdk.BlobService;
}

export declare let website: compose.Type<Website, WebsiteSpec, WebsiteProperties>;